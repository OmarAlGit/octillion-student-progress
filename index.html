<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Group 1 — Student Assessments</title>

<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">

<style>
:root{
  --bg:#0f1822;
  --panel:#0b1520;
  --firstcol:#cfd3d7;
  --head:#d9ecff;
  --grid:#223144;
  --red:#e74c3c;
  --amber:#f39c12;
  --green:#27ae60;
}
*{box-sizing:border-box}
body{
  margin:0;background:var(--bg);color:#fff;
  font-family:"Inter",system-ui,Arial,sans-serif;
}
header{background:#0b1520;text-align:center;
  font-weight:800;padding:14px;border-bottom:1px solid var(--grid);}
.wrap{max-width:1700px;margin:18px auto;padding:0 16px;}
.board{border:1px solid var(--grid);background:var(--panel);
  border-radius:14px;overflow:auto;
  box-shadow:0 20px 60px rgba(0,0,0,.35);}
table{border-collapse:separate;border-spacing:0;width:max-content;min-width:100%;}
thead th{
  background:var(--head);color:#0c1722;
  border-right:1px solid var(--grid);border-bottom:2px solid var(--grid);
  padding:12px;text-align:center;min-width:250px;}
thead th:first-child{
  background:var(--firstcol);position:sticky;left:0;z-index:6;min-width:260px;}
tbody td{
  border-right:1px solid var(--grid);border-bottom:1px solid var(--grid);
  text-align:center;padding:16px;}
tbody td:first-child{
  background:var(--firstcol);color:#0b0f13;
  font-weight:800;position:sticky;left:0;z-index:5;}
.cell{
  margin:auto;width:90%;max-width:360px;border-radius:20px;
  padding:14px 10px;color:#fff;font-weight:700;}
.red{background:var(--red);}
.amber{background:var(--amber);}
.green{background:var(--green);}
.lab{font-weight:800;}
.stamp{text-align:right;color:#90a4bf;font-size:12px;padding:10px 6px;}
</style>
</head>

<body>
<header>Group 1 — Student Assessments</header>
<div class="wrap">
  <div class="board">
    <table id="grid"><thead id="thead"></thead><tbody id="tbody"></tbody></table>
  </div>
  <div class="stamp" id="stamp">Loading…</div>
</div>

<script>
const sheetUrl =
 "https://docs.google.com/spreadsheets/d/e/2PACX-1vRTW5UzVfnAcBJdW9fSL7SXFc0wtUV5ftFWKaFExTPhq7FTv5QZ0rHqjs4sLlBnFHzCi0ThHMzV3rT_/pub?gid=1926586971&single=true&output=csv";

function parseCSV(t){
  const rows=[],r=[];let i=0,c="",q=false;
  const push=()=>{r.push(c);c="";};
  const newRow=()=>{rows.push(r.slice());r.length=0;};
  while(i<t.length){
    const ch=t[i],n=t[i+1];
    if(q){
      if(ch=='"'&&n=='"'){c+='"';i+=2;continue;}
      if(ch=='"'){q=false;i++;continue;}
      c+=ch;i++;continue;
    }else{
      if(ch=='"'){q=true;i++;continue;}
      if(ch==','){push();i++;continue;}
      if(ch=='\r'){i++;continue;}
      if(ch=='\n'){push();newRow();i++;continue;}
      c+=ch;i++;continue;
    }
  }
  if(c.length||r.length){push();newRow();}
  return rows.filter(x=>x.length);
}

function decideClass(v){
  v=(v||"").trim();
  if(!v) return "amber";          // blank -> amber
  if(/^n$/i.test(v)) return "red";// N or n -> red
  return "green";                 // date or text -> green
}

function formatCell(v,cls){
  if(cls==="green") return `<div class="cell ${cls}"><div class="lab">Completed:</div>${v}</div>`;
  if(cls==="amber") return `<div class="cell ${cls}"><div class="lab">In Progress</div></div>`;
  return `<div class="cell ${cls}"><div class="lab">Not Started</div></div>`;
}

async function load(){
  const stamp=document.getElementById("stamp");
  try{
    const res=await fetch(sheetUrl+"&cb="+Date.now());
    const txt=await res.text();
    const rows=parseCSV(txt);
    if(rows.length<2){stamp.textContent="No data.";return;}
    const headers=rows[0];
    const body=rows.slice(1);
    const thead=document.getElementById("thead");
    const tbody=document.getElementById("tbody");

    // header
    const headHTML=["<th>Group 1</th>"]
      .concat(headers.slice(1).map(h=>{
        const m=h.match(/^(.*?)\s*\((.*?)\)$/);
        const top=m?m[1]:h, sub=m?m[2]:"";
        return `<th><span class="lab">${top}</span><br><span>${sub}</span></th>`;
      })).join("");
    thead.innerHTML=`<tr>${headHTML}</tr>`;

    // rows
    tbody.innerHTML="";
    body.forEach(r=>{
      if(!r[0]) return;
      const name=r[0];
      const cells=r.slice(1).map(v=>{
        const cls=decideClass(v);
        return `<td>${formatCell(v,cls)}</td>`;
      }).join("");
      tbody.insertAdjacentHTML("beforeend",`<tr><td>${name}</td>${cells}</tr>`);
    });

    stamp.textContent="Last updated: "+new Date().toLocaleTimeString();
  }catch(e){
    console.error(e);
    stamp.textContent="Error loading data";
  }
}
load(); setInterval(load,120000);
</script>
</body>
</html>
